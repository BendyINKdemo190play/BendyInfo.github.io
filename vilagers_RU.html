<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генератор кастомных жителей для Minecraft</title>
    <link rel="stylesheet" href="style.css"> <!-- Подключение стилей -->
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #2c2c2c; /* Темный фон */
            color: #fff; /* Белый текст */
            padding: 20px;
        }

        h1 {
            color: #4CAF50;
        }

        .trade {
            margin-bottom: 20px; /* Отступ между сделками */
            border: 1px solid #ccc; /* Обводка вокруг сделки */
            padding: 10px; /* Внутренний отступ */
            border-radius: 10px; /* Скругление углов */
            background-color: #444; /* Цвет фона сделки */
        }

        button {
            margin-top: 10px;
        }

        a {
            color: orange; /* Цвет ссылок */
        }

        #itemInfo {
            margin-top: 20px; 
            border: 1px solid #ccc; 
            padding: 10px; 
            display: none; 
            background-color: #444; /* Цвет фона блока информации */
        }
    </style>
</head>
<body>

<h1>Генератор кастомных жителей для Minecraft</h1>

<div style="text-align: center;">
    <label for="profession">Профессия:</label>
    <select id="profession">
        <option value="farmer">Фермер</option>
        <option value="librarian">Библиотекарь</option>
        <option value="priest">Священник</option>
        <option value="smith">Кузнец</option>
        <option value="nitwit">Невежда</option>
    </select>

    <br><br>

    <label for="level">Уровень:</label>
    <input type="number" id="level" value="1" min="1" max="5">

    <br><br>

    <div id="tradesContainer">
        <div class="trade">
            <label for="sellItem">Торговый предмет (продажа):</label>
            <input type="text" class="sellItem" placeholder="ID предмета" required>
            <label for="sellCount">Количество:</label>
            <input type="number" class="sellCount" value="1" min="1">

            <br><br>

            <label for="buyItem1">Торговый предмет (покупка 1):</label>
            <input type="text" class="buyItem1" placeholder="ID предмета (обязательный)" required>
            <label for="buyCount1">Количество:</label>
            <input type="number" class="buyCount1" value="1" min="1">

            <br><br>

            <label for="buyItem2">Торговый предмет (покупка 2):</label>
            <input type="text" class="buyItem2" placeholder="ID предмета (необязательно)">
            <label for="buyCount2">Количество:</label>
            <input type="number" class="buyCount2" value="1" min="1"><br>

            <button onclick="removeTrade(this)">✖️ Удалить сделку</button>
        </div>
    </div>

    <button onclick="addTrade()">Добавить сделку</button>

    <br><br>

    <button onclick="generateCommand()">Сгенерировать команду</button>

    <h2 style="text-align: center;">Сгенерированная команда:</h2>
    <pre id="output" style="text-align: center;"></pre>

    <!-- Блок с информацией о предметах -->
    <div id="itemInfo">
        <h3>Список ID предметов</h3>
        <p>Вы можете найти полный список ID предметов на 
            <a href="https://ru.minecraft.wiki/w/%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:%D0%9F%D1%80%D0%B5%D0%B4%D0%BC%D0%B5%D1%82%D1%8B" target="_blank">русской вики</a> 
            или 
            <a href="https://minecraft.fandom.com/wiki/Item_IDs" target="_blank">английской вики</a>.
        </p>
    </div>

    <!-- Кнопки для перехода на другие версии -->
    <div style="margin-top: 20px;">
        <a href="vilagers_EN.html"><button>Перейти на английскую версию</button></a>
        <a href="subtitles_RU.html"><button>Перейти на Генератор команды tellraw для Minecraft 1.21.1</button></a>
    </div>
</div>

<script>
// Функция для загрузки предметов из файла JSON
async function loadItems() {
    const response = await fetch('items.json');
    const items = await response.json();
    
    return items;
}

// Функция для добавления новой сделки
async function addTrade() {
    const tradesContainer = document.getElementById('tradesContainer');
    
    const newTrade = document.createElement('div');
    newTrade.classList.add('trade');

    newTrade.innerHTML = `
        <label for='sellItem'>Торговый предмет (продажа):</label>
        <input type='text' class='sellItem' placeholder='ID предмета' required>
        <label for='sellCount'>Количество:</label>
        <input type='number' class='sellCount' value='1' min='1'>

        <br><br>

        <label for='buyItem1'>Торговый предмет (покупка 1):</label>
        <input type='text' class='buyItem1' placeholder='ID предмета (обязательный)' required>
        <label for='buyCount1'>Количество:</label>
        <input type='number' class='buyCount1' value='1' min='1'>

        <br><br>

        <label for='buyItem2'>Торговый предмет (покупка 2):</label>
        <input type='text' class='buyItem2' placeholder='ID предмета (необязательно)'>
        <label for='buyCount2'>Количество:</label>
        <input type='number' class='buyCount2' value='1' min='1'><br>
        
        <button onclick='removeTrade(this)'>✖️ Удалить сделку</button>
   `;

   tradesContainer.appendChild(newTrade);
}

// Функция для удаления сделки
function removeTrade(button) {
    const tradeToRemove = button.parentElement; // Получаем родительский элемент (сделку)
    tradeToRemove.remove(); // Удаляем сделку
}

// Функция для генерации команды
function generateCommand() {
    const profession = document.getElementById('profession').value;
    const level = document.getElementById('level').value;

    let trades = [];
    
    const tradesElements = document.querySelectorAll('.trade');
    
    tradesElements.forEach(trade => {
        const sellItem = trade.querySelector('.sellItem').value || 'minecraft:stone'; // Значение по умолчанию
        const sellCount = trade.querySelector('.sellCount').value;

        const buyItem1 = trade.querySelector('.buyItem1').value || 'minecraft:stone'; // Значение по умолчанию
        const buyCount1 = trade.querySelector('.buyCount1').value;

        const buyItem2 = trade.querySelector('.buyItem2').value || 'minecraft:stone'; // Значение по умолчанию
        const buyCount2 = trade.querySelector('.buyCount2').value;

        if (sellItem) {
            trades.push(`{buy:{id:${buyItem1},Count:${buyCount1}},sell:{id:${sellItem},Count:${sellCount}}}`);
            
            if(buyItem2) { // Если второй предмет указан, добавляем его в сделку
                trades.push(`{buy:{id:${buyItem2},Count:${buyCount2}},sell:{id:${sellItem},Count:${sellCount}}}`);
            }
        }
    });

    let command = `/summon minecraft:villager ~ ~ ~ {VillagerData:{type:plains,profession:${profession},level:${level}},Offers:{Recipes:[${trades.join(',')}]}}}`;

    document.getElementById('output').textContent = command; // Отображаем сгенерированную команду
}

// Инициализация первой сделки при загрузке страницы
window.onload = () => {
   addTrade();
   document.getElementById('itemInfo').style.display = 'block'; // Показываем блок с информацией о предметах
};
</script>

</body>
</html>
